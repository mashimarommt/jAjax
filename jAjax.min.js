(function () {
    function c(f) {
        var e = "";
        if (f) {
            for (var d in f) {
                e += "&" + d + "=" + f[d]
            }
            e.substr(1)
        }
        return e
    }

    function a(e, g, d) {
        var f = "";
        if (e) {
            if (d) {
                if (c(g)) {
                    f = e + "?" + c(g)
                }
            } else {
                f = e + "?t=" + Math.random();
                if (c(g)) {
                    f += "&" + c(g)
                }
            }
        }
        return f
    }

    var b = {};
    b.request = function (d, f, g, e, i, l, j) {
        var k = new XMLHttpRequest();
        var h = {};
        if (d.toUpperCase() == "GET") {
            k.open("GET", encodeURI(a(f, i, e)), g);
            k.send();
            if (!g) {
                if (k.status == 200) {
                    h = JSON.parse(k.responseText);
                    l(h)
                } else {
                    j()
                }
            }
        } else {
            if (d.toUpperCase() == "POST") {
                k.open("POST", encodeURI(f), g);
                k.setRequestHeader("Content-Type", "application/json");
                k.send(JSON.stringify(i));
                if (!g) {
                    if (k.status == 200) {
                        h = JSON.parse(k.responseText);
                        l(h)
                    } else {
                        j()
                    }
                }
            }
        }
        k.onreadystatechange = function () {
            if (k.readyState == 4) {
                if (k.status == 200) {
                    h = JSON.parse(k.responseText);
                    l(h)
                } else {
                    j()
                }
            }
        }
    };
    b.get = function (e, f, d) {
        b.request("GET", e, true, false, f, d, null)
    };
    b.post = function (e, f, d) {
        b.request("POST", e, true, false, f, d, null)
    };
    b.upload = function (d, k, l, h) {
        var f = new FormData();
        var e = document.getElementById(k).getAttribute("name");
        var i = document.getElementById(k).files[0];
        f.append(e, i);
        var j = new XMLHttpRequest();
        var g = {};
        j.open("POST", encodeURI(d), true);
        j.send(f);
        j.onreadystatechange = function () {
            if (j.readyState == 4) {
                if (j.status == 200) {
                    g = JSON.parse(j.responseText);
                    l(g)
                } else {
                    h()
                }
            }
        }
    };
    window.jAjax = b
})();